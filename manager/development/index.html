<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Marek S. Lukasiewicz" /><link rel="canonical" href="https://marsh-sim.github.io/manager/development/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Development - MARSH Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../external_links.css" rel="stylesheet" />
        <link href="../../mavlink_table.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Development";
        var mkdocs_page_input_path = "manager/development.md";
        var mkdocs_page_url = "/manager/development/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MARSH Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Manager</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">MARSH Manager</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Development</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#downloading-the-source-code">Downloading the source code</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#building-the-project">Building the project</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mavlink-library">MAVLink library</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#qt-application">Qt application</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#optional-qt-creator-configuration">Optional: Qt Creator configuration</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#formatting">Formatting</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Nodes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/">Simulator nodes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/controls/">Controls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/instruments/">Instruments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/eye-tracking/">Eye tracking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/body-pose/">Body pose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nodes/development/">Development</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../analysis/matlab/">MATLAB</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MAVLink definitions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/minimal/">Minimal Set</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/common/">Subset of Common Set</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/marsh/">MARSH Dialect</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Project</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../rationale/">Rationale</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/">Documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bibliography/">Bibliography</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MARSH Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Manager</li>
      <li class="breadcrumb-item active">Development</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/marsh-sim/marsh-sim.github.io/edit/main/docs/manager/development.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="develpment">Develpment</h1>
<h2 id="prerequisites">Prerequisites</h2>
<p>The development is done on Ubuntu 22.04 and Windows 10.
The application will probably work on other platforms, but only those targets are supported.</p>
<ul>
<li><a href="https://git-scm.com/">Git</a></li>
<li><a href="https://www.python.org/">Python</a></li>
<li>A C++ 17 compiler for the platform<ul>
<li>GCC for Linux</li>
<li>MSVC for Windows (installed with Visual Studio)</li>
</ul>
</li>
<li><a href="https://www.qt.io/download-open-source">Qt for Open Source Development</a><ul>
<li>Qt version <strong>6.5</strong></li>
<li>Qt Creator</li>
<li><em>Ubuntu only</em>: Manually install XCB library: <code>sudo apt install libxcb-cursor0</code></li>
</ul>
</li>
<li><em>Optional, but recommended</em>: Qt installs its own CMake, but you may need to install <code>cmake-format</code> manually, with <code>pip install cmakelang</code> or <code>apt install cmake-format</code></li>
</ul>
<p><img alt="Selected components in Qt Maintenance Tool" src="../qt_components.png" /></p>
<p>To conserve disk space you can select libraries actually used in the project, see <a href="https://github.com/marsh-sim/marsh-manager/blob/main/CMakeLists.txt">the project's CMakeLists.txt</a>, but it's possible in the future more will be used.</p>
<h2 id="downloading-the-source-code">Downloading the source code</h2>
<p>To use our own dialect, the project depends on <a href="https://github.com/marsh-sim/mavlink">a fork of MAVLink</a>, included as a <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">Git Submodule</a> (which in turn has <a href="https://github.com/ArduPilot/pymavlink">pymavlink</a> inside).</p>
<p>Open the folder where you want to keep the project code, and open it in terminal.
To clone <a href="https://github.com/marsh-sim/marsh-manager">the repository</a> with its inner modules, add the <code>--recursive</code> flag:</p>
<pre><code class="language-bash">git clone https://github.com/marsh-sim/marsh-manager.git --recursive
cd marsh-manager
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you didn't get the submodules during clone, or they changed to a different commit, you can update them with: <code>git submodule update --init --recursive</code></p>
</div>
<h2 id="building-the-project">Building the project</h2>
<h3 id="mavlink-library">MAVLink library</h3>
<p>After downloading the project for the first time, or after changes in the MAVLink dialect, the communication library needs to be regenerated.
A virtual environment is recommended to avoid mixing packages installed here with system packages.
The following commands can be used for Linux:</p>
<pre><code class="language-bash">python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
</code></pre>
<p>For users on Windows, only the line to activate the virtual environment changes to:</p>
<pre><code class="language-ps1">./venv/Scripts/activate
</code></pre>
<p>With the environment activated and all prerequisites installed, run the generator script:</p>
<pre><code class="language-bash">python scripts/update_mavlink.py
</code></pre>
<h3 id="qt-application">Qt application</h3>
<p>Launch Qt Creator, click "Open Project..." on the left and open the <code>CMakeLists.txt</code> file in  the<code>marsh-manager</code> directory.</p>
<p>When shown the Configure window, mark a kit that starts with "Desktop Qt 6.5" and click "Configure Project" in the bottom right corner.</p>
<p>The project can be compiled and optionally built using the buttons in the bottom left corner, or the "Build" menu on the top menu bar.
This should rebuild all the necessary files, and optionally start the application and attach a debugger.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The details of application version are generated by CMake based on last Git commit.
You should fully run CMake after every commit. If you didn't change anything, run manually with: "Build"&nbsp;&gt;&nbsp;"Run&nbsp;CMake"</p>
</div>
<p><img alt="Build buttons in the corner" src="../build_buttons.png" /></p>
<p>The application can be built in different modes, <a href="https://stackoverflow.com/questions/8829946/whats-the-difference-between-a-qt-debug-version-and-the-qt-release-version">a short explanation quoted from Stack Overflow</a>:</p>
<blockquote>
<p>Debug versions are usually slower, larger, and take up more RAM. They have debugging symbols, which make debugging possible and simpler. Release versions are stripped of all non-production information.</p>
<p>In debug builds variables and memory are generally set to zero but in release this step is skipped to save time. Extra data is also added around objects and allocated memory as barriers to detect memory overwrites.</p>
</blockquote>
<p>In this specific project, building is noticeably faster for Debug builds.
You can differentiate Debug build from Release by the window title, in which Debug builds also have the commit count on the end of version string after a <code>+</code> sign.</p>
<p><img alt="Screenshot of MARSH Manager window with visible version" src="../version_window.png" /></p>
<h2 id="optional-qt-creator-configuration">Optional: Qt Creator configuration</h2>
<p>Qt Creator <strong>includes Vim mode</strong> ("Edit" &gt; "Preferences" &gt; "FakeVim").</p>
<h3 id="formatting">Formatting</h3>
<p>To avoid "noisy diff" where changes are just formatting changes, it's recommended to enable format on save for all used kinds of source files:</p>
<ul>
<li>In window "Edit" &gt; "Preferences":<ul>
<li>"C++" &gt; "Code Style"</li>
<li>"Qt Quick" &gt; "QML/JS Editing"</li>
<li>"CMake" &gt; "Formatter"</li>
</ul>
</li>
</ul>
<p><img alt="Setting for C++" src="../format_cpp.png" /></p>
<p><img alt="Setting for QML" src="../format_qml.png" /></p>
<p><img alt="Setting for CMake" src="../format_cmake.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../" class="btn btn-neutral float-left" title="MARSH Manager"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../nodes/" class="btn btn-neutral float-right" title="Simulator nodes">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Â© 2024, Marek S. Lukasiewicz, CC-BY 4.0</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/marsh-sim/marsh-sim.github.io" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../nodes/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
