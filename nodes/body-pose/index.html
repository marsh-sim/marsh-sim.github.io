<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Marek S. Lukasiewicz" /><link rel="canonical" href="https://marsh-sim.github.io/nodes/body-pose/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Body pose - MARSH Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../external_links.css" rel="stylesheet" />
        <link href="../../mavlink_table.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Body pose";
        var mkdocs_page_input_path = "nodes/body-pose.md";
        var mkdocs_page_url = "/nodes/body-pose/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MARSH Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Manager</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../manager/">MARSH Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../manager/development/">Development</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Nodes</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">Simulator nodes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instruments/">Instruments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../eye-tracking/">Eye tracking</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Body pose</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#windows">Windows</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#tracked-points">Tracked points</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#alternate-models">Alternate models</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/">Development</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../analysis/matlab/">MATLAB</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MAVLink definitions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/minimal/">Minimal Set</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/common/">Subset of Common Set</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../mavlink/marsh/">MARSH Dialect</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Project</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../rationale/">Rationale</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/">Documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bibliography/">Bibliography</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MARSH Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Nodes</li>
      <li class="breadcrumb-item active">Body pose</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/marsh-sim/marsh-sim.github.io/edit/main/docs/nodes/body-pose.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="body-pose-tracking">Body pose tracking</h1>
<p>A simple adapter in Python is developed in <a href="https://github.com/marsh-sim/realsense-pose-detector">MARSH-Sim public repository</a> based on <a href="https://github.com/cansik/realsense-pose-detector">RealSense Pose Detector</a> which was fairly easy to run and works, tested with Intel RealSense D455F.</p>
<p>The application sends the <a href="../../mavlink/marsh/#HUMAN_BODY_POSE">HUMAN_BODY_POSE</a> message.
Currently the 3D system of coordinates is from <strong>camera's point of view</strong>:</p>
<ul>
<li>X: forward</li>
<li>Y: right</li>
<li>Z: down</li>
</ul>
<p>The coloring scale goes between 0 or missing data - deep blue and 2 meters or more - deep red.
The camera can measure greater distances, but this makes the view of cockpit more legible.</p>
<p><img alt="screenshot of tracking adapter" src="../body_screenshot.png" /></p>
<h2 id="installation">Installation</h2>
<p>Note that the RealSense cameras require a USB-C cable <strong>with USB 3 connections</strong>.</p>
<p>The project is managed with <a href="https://docs.astral.sh/uv/getting-started/installation/">uv</a>.
This command should take care of dependencies and start the program:</p>
<pre><code class="language-sh">uv run pose.py
</code></pre>
<h3 id="windows">Windows</h3>
<p><a href="https://github.com/IntelRealSense/librealsense">Intel RealSense SDK</a>, get the latest stable release from the Releases section on the right.</p>
<h2 id="tracked-points">Tracked points</h2>
<p>Currently we're using <a href="https://ai.google.dev/edge/mediapipe/solutions/vision/pose_landmarker">Google's MediaPipe Pose Landmarker</a>.
The landmark model predicts the location of 33 full-body landmarks (see figure below), each with (<code>x, y, z, visibility</code>).
The current model does not use depth data directly, we're projecting the positions identified on 2D image into 3D space using RealSense afterwards.
This means that the position of points is centered on the joint in 2D, but on the closest surface to camera in depth.</p>
<p>Messages are sent only for points that have visibility higher than the minimum threshold.
The definitions <a href="../../mavlink/marsh/#HUMAN_BODY_POINT">HUMAN_BODY_POINT</a> start with the same indices as this model's output:</p>
<p><img alt="diagram of point positions on human body" src="../body_points.png" /></p>
<h2 id="alternate-models">Alternate models</h2>
<p>For skeletal pose estimation Intel recommends (<a href="https://github.com/IntelRealSense/librealsense/issues/6580#issuecomment-643726272">1</a>)(<a href="https://www.intel.com/content/www/us/en/support/articles/000089525/programs/e-commerce-stores.html">2</a>):</p>
<ul>
<li>FOSS <a href="https://github.com/bagridag/RealTime3DPoseTracker-OpenPose">RealTime3DPoseTracker-OpenPose</a> with 23 step installation process</li>
<li>333$ perpetual license <a href="https://www.lips-hci.com/3d-body-pose-sdk">LIPSense 3D Body Pose SDK</a></li>
<li>subscription to NUITRACK SDK</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../eye-tracking/" class="btn btn-neutral float-left" title="Eye tracking"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../development/" class="btn btn-neutral float-right" title="Development">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Â© 2024, Marek S. Lukasiewicz, CC-BY 4.0</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/marsh-sim/marsh-sim.github.io" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../eye-tracking/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../development/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
